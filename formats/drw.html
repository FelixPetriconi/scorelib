---
layout: default
permalink: formats/drw/index.html
breadcrumbs: [['/formats','formats']]
javascript: ['js/turnonoff-sticky.html']
pagetitle:  SCORE DRAW data format
grouptitle: ['/formats', 'Data formats']
group: [ 
   ['/formats/binary/', binary], 
   ['/formats/pmx/', PMX], 
   ['/formats/ppmx/', PPMX],
   ['/formats/drw/', DRW] 
]
---

"DRW" files are used to store the musical font used to typeset SCORE files. 
They are binary files that store up to 10 symbols per file.  Typically
DRAW files are stored in the LIB subdirectory, starting with LIBRA.DRW for 
the first 10 symbols of the musical font, then LIBRB.DRW for the next 10,
and so on.  DRW files can be edited with the DRAW.EXE program which comes
with the SCORE editor.

<p>
Here is the binary version of a DRW file with the various components colored:
</p>


<style>
.drwbytes   { 
	font-family: Courier, sans-serif;
	font-weight: 600;
	margin-top: 20px;
}
span.magic     { color: gray;    font-family: Courier, sans-serif; font-weight: 600; }
span.offsets   { color: green;   font-family: Courier, sans-serif; font-weight: 600; }
span.xnames    { color: blue;    font-family: Courier, sans-serif; font-weight: 600; }
span.startsize { color: red;     font-family: Courier, sans-serif; font-weight: 600; }
span.endsize   { color: orange;  font-family: Courier, sans-serif; font-weight: 600; }
span.vector    { color: black;   font-family: Courier, sans-serif; font-weight: 600; }
</style>

{% include /formats/drw/draw.html %}

<p>The meaning of each colored section:</p>

<style>
li {margin-top: 10px;}
</style>

<ul class="xlist" style="margin-top:20px;">
<li> <span class="magic">first byte</span> &mdash; 
The first byte in a DRW file is always hex 4b, or decimal 180.

<li> <span class="startsize">starting chunk size</span> &mdash;
Data bytes are stored in chunks, with each chunk starting with a single
byte chunk size.  This is the number of bytes in the chunk following
the value which are data bytes.  The header chunk always has 72 (hex 48)
bytes.  Vector data chunks usually have 129

<li> <span class="endsize">ending chunk size</span> &mdash;
All chunks except the last one are terminated with a duplicate 
byte count for the chunk.  This byte is not considered when counting
the bytes in the header chunk, but is considered when counting the
bytes in subsequent vector data chunks.

<li> <span class="offsets">vector word offsets</span> &mdash; This
is a list of the two-byte word offsets for the vectors describing
each symbol.  The offsets are themselves given as two-byte integers
in little endian format.  There are always 11 offset numbers (22 bytes),
with the first offset always being 1.  The count of numbers in
each symbol's vector is the next offset minus the current offset, with
the last offset giving the total count of numbers in the list of 
vectors.

<p> For this example:</p>

<div style="margin-left:50px">
    <span class="offsets">01 00</span> &rarr; 1 &rarr; 37 &ndash; 1 = 36 numbers = 12 vectors for symbol 0
<br><span class="offsets">25 00</span> &rarr; 37 &rarr; 73 &ndash; 37 = 36 numbers = 12 vectors for symbol 1
<br><span class="offsets">49 00</span> &rarr; 73 &rarr; 109 &ndash; 73 = 36 numbers = 12 vectors for symbol 2
<br><span class="offsets">6d 00</span> &rarr; 109 &rarr; 145 &ndash; 109 = 36 numbers = 12 vectors for symbol 3
<br><span class="offsets">91 00</span> &rarr; 145 &rarr; 175 &ndash; 145 = 30 numbers = 10 vectors for symbol 4
<br><span class="offsets">af 00</span> &rarr; 175 &rarr; 190 &ndash; 175 = 15 numbers = 5 vectors for symbol 5
<br><span class="offsets">be 00</span> &rarr; 190 &rarr; 220 &ndash; 190 = 30 numbers = 10 vectors for symbol 6
<br><span class="offsets">dc 00</span> &rarr; 200 &rarr; 235 &ndash; 220 = 15 numbers = 5 vectors for symbol 7
<br><span class="offsets">eb 00</span> &rarr; 235 &rarr; 271 &ndash; 235 = 36 numbers = 12 vectors for symbol 8
<br><span class="offsets">0f 01</span> &rarr; 271 &rarr; 292 &ndash; 271 = 21 numbers = 7 vectors for symbol 9
<br><span class="offsets">24 01</span> &rarr; 292 &rarr; 291 vectors in file.
</div>

<p> The offset values should always increase, but may be set to 0 if there
is no symbol for the given position.  The last number is always the 
total number of bytes in the vectors plus one (which may repeat the 
value of the last non-zero entry.

<p> The differences between successive offsets must always be divisible
by three without a remainder.  The byte size of the first symbol in this 
example is 37 &ndash; 1 = 36, which is divisible by three.  This means
that there are 12 vectors defining the first symbol in the file.

<li> <span class="xnames">symbol labels</span> &mdash;
Each symbol can be given a five-character (ASCII bytes) name.  If the name
is less than five characters, then the rest of the space for a name is padded
with space characters. The names cannot exceed five characters.

<p> Here are the ten symbol names for the example file:</p>

<div style="margin-left:50px">
    <span class="xnames">73 68 61 72 70</span> &rarr; "sharp"
<br><span class="xnames">66 6c 61 74 20</span> &rarr; "flat"
<br><span class="xnames">73 74 61 63 63</span> &rarr; "stacc"
<br><span class="xnames">74 72 69 6c 6c</span> &rarr; "trill"
<br><span class="xnames">77 68 6f 6c 65</span> &rarr; "whole"
<br><span class="xnames">74 65 6e 75 74</span> &rarr; "tenut"
<br><span class="xnames">62 61 73 73 20</span> &rarr; "bass"
<br><span class="xnames">61 6c 74 6f 20</span> &rarr; "alto"
<br><span class="xnames">70 65 72 63 20</span> &rarr; "perc"
<br><span class="xnames">6d 6f 72 64 20</span> &rarr; "mord"
</div>

<p> These labels are not used by the SCORE editor, but can be
useful for figuring out the purpose of the symbol.


<li> <span class="vector">vector data</span> &mdash;
For each symbol in the file a list of vectors is given in
all subsequent chunks after the header chunk.  Each vector consists
of three numbers, and each number is stored as a two-byte signed
little endian integer.  The byte offsets in the header are used to
count the number of vector bytes for each symbol.  The chunk byte
sizes are not counted in the header offsets.

<p> Here are the bytes describing the vectors of the first symbol: </p>

<div style="margin-left:50px">
    <span class="vector">5a 00 7e ff 01 00</span> &rarr; (90, -130, 1)
<br><span class="vector">5b 00 14 00 00 00</span> &rarr; (91, 20, 0)
<br><span class="vector">5c 00 15 00 02 00</span> &rarr; (92, 21, 2)
<br><span class="vector">00 00 16 00 00 00</span> &rarr; (0, 22, 0
<br><span class="vector">01 00 e0 ff 00 00</span> &rarr; (1, -32, 0)
<br><span class="vector">5f 00 eb ff 00 00</span> &rarr; (95, -21, 0)
<br><span class="vector">5d 00 16 00 00 00</span> &rarr; (93, 22, 0)
<br><span class="vector">5c 00 0f 00 03 00</span> &rarr; (92, 15, 3)
<br><span class="vector">5b 00 f2 ff 00 00</span> &rarr; (91, -14, 0)
<br><span class="vector">04 00 f3 ff 00 00</span> &rarr; (4, -13, 0)
<br><span class="vector">05 00 0d 00 00 00</span> &rarr; (5, 13, 0)
<br><span class="vector">50 00 0d 00 00 00</span> &rarr; (80, 13 ,0)
</div>

<p> The first two numbers describe the horizontal and vertical
positions of a point in the outline of a font.  The origin is at (0, 0) and 
coordinates can be positive or negative.  Coordinates can only be 
two-byte signed integers.  The default scale means that the height of
a staff space is 7 units.  Typically symbols will be described at a larger
scale and then shrunk when placing on the page.  For example the treble clef
symbol is described at 8 times its normal scaling.  This is equivalent 
to allowing fractional values for the coordinates.

<p> The third number in a vector triplet describes operations on the outline:

<ul>
<li> 0 = draw a straight line from the previous point to the current point.
<li> 1 = start a new line.
<li> 2 = start a filled area.  Note that all fill areas are also stroked (with
     the width determined at print time, so filled areas are thinner than 
     the final graphical shape which has an extra border due to the stroking.
<li> 3 = start an unfilled area within a filled area.
</ul>

</ul>


